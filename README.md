# Прогнозирование индекса загрязнения воздуха в городе

Цель исследования - построить модель пронозирования базового индекса загрязнения воздуха, основываясь на исторических данных

## Источник данных

Данные о базовом индексе загрязнения воздуха берутся с _API_ предоставляемым сервисом _OpenWeather_. _API_ загрязнения воздуха предоставляет текущие, прогнозные и исторические данные о загрязнении воздуха для любых координат на земном шаре. Помимо базового индекса качества воздуха API возвращает данные о загрязняющих газах, таких как монооксид углерода (CO), монооксид азота (NO), диоксид азота (NO2), озон (O3), диоксид серы (SO2), аммиак (NH3) и твердые частицы (PM2.5 и PM10). Прогноз загрязнения воздуха доступен на 5 дней с почасовой детализацией. Исторические данные доступны с 27 ноября 2020 года. 

## Ход исслеования

Для решения данной задачи было предложжено рассмотреть несколько моделей прогнозирования: 
- статистическую модель SARIMA
- полносвязную нейронную сеть
- рекуррентную нейронную сеть

Перед моделированием данные обработали, проверили на пропуски и провели первичный анализ на наличие сезонности и тренда в данных.

После обработки данных перешли к созданию статистической модели SARIMA, подобрали верхний границы модели по графикам автокорреляции и частичной автокорреляции и запустили процесс обхода всех возможных сочетаний параметров.

Второй моделью выбрали реккурентную нейронну сеть с дополнительным сверточным одномерным слоем на входных данных. Для нее дополнительно написали служебные функции для разделения временного ряда на отдельные промежутки с определенным окном между ними, а также перемешали их между собой. 

Третья модель использовала те же функции, что и вторая, единственным отличием была только сама архитектура модели.

## Итоги

Сравнили по метрикам доли правильных ответов и средней абсолютной ошибки, из которых стало ясно, что модель ARIMA хорошо описывает исторические значения, но с прогнозными значениями возникали ошибки. Нейронная сеть без свертки сильно сглаживает все значения временного ряда, а нейронная сеть со сверточным слоем с высокой точностью описываем как исторические, так и прогнозные данные.

В заключение, модель со сверточным нейронным слоем можно дообучить на большем количестве эпох и начать использовать для прогнозирования базового индекса загрязнения воздуха в городе Омске.
